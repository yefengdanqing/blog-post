---
title: babylon遗漏学习
toc: true
date: 2023-05-04 22:26:59
tags:
- 
categories:
- 
typora-root-url: ..\img
---

# 数据

## 背景

一个图节点有三种角色，一个是他只是依赖，比如由是输入节点，数据已经准备就绪；第二种是中间节点，即被依赖，也需要作为输出节点；第三种就是纯输出节点，完全有图输出，后续不被使用和依赖

[依赖相对于是对图节点来说的概念，需要再理解一下]

所有的节点都是数据，包括输入和输出；只是从输出数据（或者算子）的角度来看，他是依赖关系，需要保存这种依赖关系



发布数据：Committer是 两阶段发布模式的提交器，用于操作待发布数据，并控制发布的最终提交生效；

<!-- more -->

## GraphData

![grc-GraphData](/../../../../../工作图库/grc-GraphData.jpg)

## GraphDependency

![grc-GraphDepency](/../../../../../工作图库/grc-GraphDepency.jpg)

![image-20241128195859711](/../../../../../Library/Application Support/typora-user-images/image-20241128195859711.png)

```c++
_data->release();//很重要的数据发布
```

一个graphdata的依赖（dependecy)就是这个vertex的输入(可能是初始化的输入，也可能是上一个vertex的依赖;

一个dependency的target是对应的输入数据，他的source是执行的vertex;

## GraphVertexBuilder【_named_dependencies&_named_emits数组】

* builder通过add_vertex获取每个算子对应的new 出来的GraphVertexBuilder
* GraphVertexBuilder可以添加命名或者匿名依赖，并且为每个依赖指定名字（_target)
  * 如果依赖不存在于GraphVertexBuilder中，创建对应的GraphDependencyBuilder，并且指定name
  * xxx
* xxx

![image-20250122114824681](/../../../../../Library/Application Support/typora-user-images/image-20250122114824681.png)

## 问题

* ::std::string _name;和 ::std::string _target;有啥区别呢
* 怎么理解一个graphdata 的_target是什么意思？？
* 怎么理解一个dependency的_target是什么意思？？（依赖的target是一个graphdata,这个graph data可以是输入（外部emit)或者是vertex 来emit
* inline ::std::ostream& operator<<(::std::ostream& os, const GraphData& data) {

    os << "data[" << data._name << "]";

    return os;

  }


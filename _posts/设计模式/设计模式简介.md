---
title: 设计模式简介
toc: true
date: 2023-02-04 22:26:59
tags:
- c++
categories:
- 设计模式
typora-root-url: ..\img
---

### 概念

每一种模式描述了在我们周围不断重复发生的问题，以及该问题的核心解决方案。这样我们就能重复的使用该核心解决方案，而不用做重复的工作。

#### 面向对象

向下：深入理解 封装、继承、多态的意义（ok)

向上：结合以上三个特性来表达真实世界，将真实世界用以上特征抽象成对象。

#### 复杂性

方案1：即分而治之，将大问题分 解为多个小问题，将复杂问题分解为多个简单问题；

方案2：人们处理复制问题，只有能将这个问题进行抽象。我们要忽略所抽象出来的都是本质的特性，要忽略其非本质特性。

<!-- more -->

#### 面向对象（抽象）

##### 隔离变化

面向对象能将带来减小变化的影响到极低；面向对象也能适应这种变化

##### 各司其职

新的对象不影响老的对象

#### 面向对象8大设计原则

```
软件设计的八大原则是一组指导性原则，旨在帮助开发人员设计出高质量、可维护和可扩展的软件。以下是这些原则的详细解释：

单一职责原则（Single Responsibility Principle，SRP）：一个类应该只有一个引起它变化的原因。这意味着一个类应该只负责一项功能或关注点。如果一个类承担了过多的职责，那么它将变得复杂、难以维护，并且对于任何一个改变都会产生连锁反应。


里氏替换原则（Liskov Substitution Principle，LSP）：子类型必须能够替代其基类型，即派生类必须能够替代其基类而不产生意外或错误的行为。这个原则强调继承关系中的一致性和合理使用继承。

接口隔离原则（Interface Segregation Principle，ISP）：客户端不应该强迫依赖于它们不使用的接口。类应该专注于其需要的接口，而不是实现多余的接口。这个原则鼓励将庞大的接口拆分成更小、更具体的接口，以避免不必要的依赖和臃肿的实现。

迪米特法则（Law of Demeter，LoD）：一个对象应该与其他对象之间保持最少的了解。只与你直接的朋友交谈，不要和陌生人说话。这个原则鼓励减少对象之间的耦合性，使代码更加模块化、独立和可维护。

组合/聚合复用原则（Composite/Aggregate Reuse Principle，CARP）：优先使用组合/聚合关系来达到代码复用的目的，而不是使用继承。继承是一种紧耦合关系，容易导致脆弱的代码结构。组合/聚合关系更加灵活，允许通过组合不同的对象来实现代码的复用。

最少知识原则（Principle of Least Knowledge，PLK）：一个对象应该对其他对象有尽可能少的了解，减少对象之间的耦合性。只与直接相互作用的对象进行通信。这个原则促进了对象之间的低耦合性，提高了系统的灵活性和可维护性。

这些原则是面向对象设计和软件工程中的重要

下面是对软件设计的八大原则的简要说明，并附带了一些示例：

单一职责原则（SRP）：一个类应该只有一个引起它变化的原因。例如，一个负责处理用户验证的类不应该同时负责数据持久化的功能。



里氏替换原则（LSP）：子类型必须能够替代其基类型。例如，如果有一个基类 Animal 和派生类 Dog 和 Cat，那么可以将 Dog 或 Cat 实例赋值给 Animal 类型的变量。

依赖倒置原则（DIP）：高层模块不应依赖于低层模块，二者都应该依赖于抽象。例如，将具体的数据库访问逻辑封装在一个接口中，然后高层模块通过依赖该接口来实现与数据库的交互。

接口隔离原则（ISP）：客户端不应强迫依赖于不需要使用的接口。例如，将庞大的接口拆分成多个小接口，以满足不同客户端的需求。

迪米特法则（LoD）：一个对象应该与其他对象之间保持最少的了解。例如，在一个系统中，一个类不应该直接访问其他类的私有成员，而应该通过公共接口进行通信。

组合/聚合复用原则（CARP）：优先使用组合/聚合关系来达到代码复用的目的，而不是使用继承。例如，通过将多个相互独立的类组合在一起形成一个新的对象，以实现更灵活的代码复用。

最少知识原则（PLK）：一个对象应该尽可能少地了解其他对象。例如，在一个系统中，一个类应该仅与其直接的朋友（即紧密相关的类）进行交互，不应该直接与其他类进行通信。

这些原则提供了指导和规范，帮助设计出灵活、可维护和可扩展的软件系统。实际上，这些原则通常会相互结合和重叠，以获得更好的设计结果。
```

##### 依赖倒置原则（dip)

1. 高层模块（稳定不变化的）不依赖于底层模块（不稳定，变化的），二者都依赖于抽象（稳定、不变化的）
2. 抽象（稳定）不应该依赖实现细节（变化），具体实现细节应该依赖于抽象。这个原则通过使用接口或抽象类，将高层模块与低层模块之间的直接依赖关系转移到了抽象层面，从而降低了模块之间的耦合性。将变化进行单独隔离，当做新的一部分，最好不要修改原来的部分。

##### 开放封闭原则（Open-Closed Principle，OCP)

开闭原则（Open-Closed Principle，OCP）是面向对象设计中的一项重要原则。该原则指导着软件实体（类、模块、函数等）应该对扩展开放，对修改关闭。

开闭原则的核心思想是尽量通过增加新代码来扩展系统的功能，而不是直接修改已有的代码。这样做的好处是保护了现有的稳定功能，减少了引入新错误的风险，并提高了代码的可维护性和可扩展性。

以下是开闭原则的一些关键要点：

1. 对扩展开放：软件实体应该允许在不修改其源代码的情况下进行扩展。这意味着可以通过添加新的类、接口、方法或属性来增加新的功能。
2. 对修改关闭：已有的代码不应该被修改，以避免破坏现有的功能和稳定性。如果需要修改已有代码，则应考虑使用扩展点、抽象类、接口等机制，以支持扩展而不是直接修改。
3. 利用抽象和多态：采用抽象类、接口和多态的方式编写代码，可以更好地达到开闭原则。通过面向接口编程，可以将具体实现与调用方解耦，从而使得在不修改调用方代码的情况下，可以轻松替换和扩展具体实现。
4. 设计合适的扩展点：在设计时，需要预留合适的扩展点以便于扩展功能。这可以通过使用设计模式（如策略模式、装饰器模式）或事件驱动机制来实现。

遵循开闭原则能够让软件系统更具灵活性、可扩展性和可维护性。当需求变化时，我们只需要新增代码来扩展功能，而不必担心对现有代码的影响和修改，从而降低了软件的维护成本和风险。

然而，完全地遵守开闭原则可能会带来一定的复杂性，因为需要在设计上进行更多的抽象和准备工作。因此，在实践中需要权衡利弊，根据具体情况选择适当的扩展方式。

##### 单一原则
1. 一个类应该只有一个引起它变化的原因。这意味着一个类应该只负责一项功能或关注点。如果一个类承担了过多的职责，那么它将变得复杂、难以维护，并且对于任何一个改变都会产生连锁反应。一个负责处理用户验证的类不应该同时负责数据持久化的功能。
##### liskov替换原则
1. 子类必须能够替换他们的基类或者父类
2. 继承表达类型抽象
##### 接口隔离原则
1. 不应该强制客户程序依赖他们不用的方法
2. 接口应该小而完备
##### 优先使用对象组合，而不是类继承
1. 继承通常类似是”白箱复用“，对象组合通常类似”黑箱复用“
2. 继承破坏了封装性，子父类耦合度比较高；组合只是要求对象有清晰的接口，不需要有
#####

##### 接口封装原则

##### 最少知识原则



#### 设计模式分类

##### 目的分类

###### 创建型

提供创建对象的机制，保证已有代码的灵活性和可重复利用

###### 结构型

将对象和类组装成较大的结构，可能是继承或者组合；同时保持结构的灵活和高效；

结构型模式可以分为类结构型模式和对象结构型模式

- 类结构型模式关心类的组合，由多个类可以组合成一个更大的系统，在类结构型模式中一般只存在继承关系和实现关系。 
- 对象结构型模式关心类与对象的组合，通过关联关系使得在一 个类中定义另一个类的实例对象，然后通过该对象调用其方法。 根据“合成复用原则”，在系统中尽量使用关联关系来替代继 承关系，因此大部分结构型模式都是对象结构型模式。

###### 行为型

在不同的**对象**间的高效沟通和职责委派；通过行为型模式，我们可以很清晰的话

行为型模式不仅仅关注类和对象的结构，而且重点关注它们之间的相互作用。

行为型模式分为类行为型模式和对象行为型模式两种：

- 类行为型模式：类的行为型模式使用继承关系在几个类之间分配行为，类行为型模式主要通过多态等方式来分配父类与子类的职责。
- 对象行为型模式：对象的行为型模式则使用对象的聚合关联关系来分配行为，对象行为型模式主要是通过对象关联等方式来分配两个或多个类的职责。根据“合成复用原则”，系统中要尽量使用关联关系来取代继承关系，因此大部分行为型设计模式都属于对象行为型设计模式。

包含模式

- 职责链模式(Chain of Responsibility) 重要程度：3（5为满分）
- 命令模式(Command)重要程度：4
- 解释器模式(Interpreter)重要程度：1
- 迭代器模式(Iterator)重要程度：5
- 中介者模式(Mediator) 重要程度：2
- 备忘录模式(Memento) 重要程度：2
- 观察者模式(Observer)重要程度：5
- 状态模式(State)重要程度：3
- 策略模式(Strategy)重要程度：4
- 模板方法模式(Template Method)重要程度：3
- 访问者模式(Visitor)重要程度：1

##### 范围类看

类模式处理类和类的子类之间的静态关系（继承）

对象模式处理对象之间的动态关系（组合）

#### 重构获得模式

面向对象设计模式是"好的面向对象设计"，所谓好的设计模式是指那些可以“面对变化，提高复用”的设计

现代软件设计的特点是：需求的频繁变化。设计模式的意义是寻找变化点，在变化点处应用设计模式，从而更好的应对需求的变化；在什么地点和什么时候应用设计模式比理解设计模式本身更重要

设计模式使用不应该先入为主，一上来就使用设计模式是一种最愚蠢的行为，而是考虑 在**重构**的过程中使用设计模式。

重构关键技法

* 静态-->动态
* 早绑定 -->晚绑定
* 继承-->组合 
* 编译时依赖 -->运行时依赖 
* 紧耦合 --> 松耦合











#### 杂项

1. 
2. 高层模块（稳定不变化的）不依赖于底层模块（不稳定，变化的），都依赖于抽象（稳定、不变化的）

###### 引用

https://www.jianshu.com/p/1207e9b14997

https://refactoringguru.cn/design-patterns#intro-classification






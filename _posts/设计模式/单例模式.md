---
title: 单例模式
toc: true
date: 2022-03-04 22:26:59
tags:
- c++
categories:
- 设计模式
typora-root-url: ..\img
---

#### 概念

#### 实现方式（类图）

#### 举例

##### 动机

<!-- more -->

##### 实际场景



##### 使用方法（核心代码）

```c++
//具体见github

```

#### 模式适合应用场景

#### 模式优缺点

##### 优点：

##### 缺点：

#### 与其他模式的关系

#### 其他

###### 项目应用场景

- 场景

  - 日志类、配置类

  - 数据库连接池、多线程池

<!-- more -->

- 线程不安全版本

  ```c++
  class SingleInstance {
  public:
      static SingleInstance* get_instance() {
          if （obj ！= nullptr）{
              obj = new SingleInstance();
          return obj;
      }
  private:
      static SingleInstance* obj;//类内静态变量初始化
      SingleInstance();
      SingleInstance(const SingleInstance&);
      SingleInstance(const SingleInstance&&)
      SingleInstance& operator= (const SingleInstance&);
      SingleInstance& operator= (const SingleInstance&&)
      ~SingleInstance();
  
  };
  //静态的
  SingleInstance SingleInstance::obj = nullptr;
  ```

- 线程安全版本(加锁版本和双检查锁版本)

  ```
  std::mutex mt;
  class SingleInstance {
  public:
      static SingleInstance* get_instance() {
          std::lock_guard<mutex> lock(mt)
          if （obj ！= nullptr）{
              obj = new SingleInstance();
          return obj;
      }
  private:
     	static SingleInstance* obj;//类内静态变量初始化
      SingleInstance();
      SingleInstance(const SingleInstance&);
      SingleInstance(const SingleInstance&&)
      SingleInstance& operator= (const SingleInstance&);
      SingleInstance& operator= (const SingleInstance&&)
      ~SingleInstance();
  
  };
  //静态的
  SingleInstance SingleInstance::obj = nullptr;
  ```

- c++11 版本

  局部静态变量可以延迟对象的构造，等到第一次调用时才进行构造。
  
  ```c++
  class SingleInstance {
  public:
      static SingleInstance& get_instance() {
          static SingleInstance obj;
          return obj;
      }
  private:
      SingleInstance();
      SingleInstance(const SingleInstance&);
      SingleInstance(const SingleInstance&&)
      SingleInstance& operator= (const SingleInstance&);
      SingleInstance& operator= (const SingleInstance&&)
      ~SingleInstance();
  
  };
  ```









#### 概念

#### 举例

##### 实际场景

比如每个人都要上班，每个人要打卡，也要下班；但是每个人可能做的事情不一样，有美工，有程序员，有财务等

##### 使用方法

#### 模板方法模式适合应用场景

#### 实现方式

#### 模板方法模式优缺点

#### 与其他模式的关系

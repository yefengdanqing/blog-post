---
title: 召回
toc: true
date: xxxx-xx-xx 22:26:59
tags:
- 
categories:
- 
typora-root-url: ..\img
---

#### 召回模块展开来主要分三个阶段，**召回、过滤和粗排**。

**召回模块**接收到DSP给流量请求中包含了用户信息和上下文信息。广告主设置的广告投放存在[Ad Meta db](https://zhida.zhihu.com/search?content_id=112599857&content_type=Article&match_order=1&q=Ad+Meta+db&zd_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJ6aGlkYV9zZXJ2ZXIiLCJleHAiOjE3NTA0MDc0NzcsInEiOiJBZCBNZXRhIGRiIiwiemhpZGFfc291cmNlIjoiZW50aXR5IiwiY29udGVudF9pZCI6MTEyNTk5ODU3LCJjb250ZW50X3R5cGUiOiJBcnRpY2xlIiwibWF0Y2hfb3JkZXIiOjEsInpkX3Rva2VuIjpudWxsfQ.btFfu_glALuEx-p0NeR4C69q0BxSgLv4h_NRgG5MHfU&zhida_source=entity)中，然后建成相关的广告索引（Ad index），投放更新后才会实时更新这个索引。[RTDB](https://zhida.zhihu.com/search?content_id=112599857&content_type=Article&match_order=1&q=RTDB&zd_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJ6aGlkYV9zZXJ2ZXIiLCJleHAiOjE3NTA0MDc0NzcsInEiOiJSVERCIiwiemhpZGFfc291cmNlIjoiZW50aXR5IiwiY29udGVudF9pZCI6MTEyNTk5ODU3LCJjb250ZW50X3R5cGUiOiJBcnRpY2xlIiwibWF0Y2hfb3JkZXIiOjEsInpkX3Rva2VuIjpudWxsfQ.9H6CK7dZPICrJOt_ItK1TRm3xaoN0VmgPx6betXCRfU&zhida_source=entity)主要存储用户标签数据，标签数据一部分是通过请求中带的**用户信息**和**上下文信息**进行用户标签的实时更新，另一部分是通过线下离线全量更新。

![img](https://picx.zhimg.com/v2-7b1ded529f7789b23f65b4ba80975c89_1440w.jpg)

接下来讲一下在我们检索召回中一些通路，我们是进行**多路召回的**，其中有三种类型，第一种是上下文、第二种是用户行为、第三种是当前正在做的[深度召回](https://zhida.zhihu.com/search?content_id=112599857&content_type=Article&match_order=1&q=深度召回&zd_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJ6aGlkYV9zZXJ2ZXIiLCJleHAiOjE3NTA0MDc0NzcsInEiOiLmt7Hluqblj6zlm54iLCJ6aGlkYV9zb3VyY2UiOiJlbnRpdHkiLCJjb250ZW50X2lkIjoxMTI1OTk4NTcsImNvbnRlbnRfdHlwZSI6IkFydGljbGUiLCJtYXRjaF9vcmRlciI6MSwiemRfdG9rZW4iOm51bGx9.WHQUviwGd-C5uZ2MJIPI0GyLJr-PMXJVb4J_Z3sMYM8&zhida_source=entity)。

<!-- more -->

上下文召回有这几种类型，第一种是基于图片的，在内容页场景下，一个明星穿了哪件衣服，根据这件衣服投放哪件商品，做法是将图片向量化，计算广告商品与图片向量的相似度进行召回。第二种是基于标题的，主要是基于文本NLP相关模型进行召回。第三种是基于lbs的，广告主自身设定某个标签区域进行投放，在该区域内进行标签匹配召回，属于布尔召回。

用户行为召回有这几种类型，第一种是基于兴趣的，基于用户历史行为建立用户画像，打上兴趣标签，进行布尔召回。第二种是基于Query的，利用用户的query历史行为，进行NLP相关模型进行召回，与基于标题的方式类似。第三种是基于访问行为，利用广告主回传的用户商品行为，采用Item CF、ALS、Neural MF等模型进行召回。

最后一种召回通路是深度召回，主要是把user profile、媒体特性、上下文特性等特征结合起来进入深度模型中进行召回，接下来会具体介绍下这个是如何做的。深度树召回

| 模型名称                | 模型类型     | 简要说明                                                     |
| ----------------------- | ------------ | ------------------------------------------------------------ |
| **ItemCF**              | 协同过滤     | 根据用户历史点击/加购商品，召回与这些商品被“同一批人”喜欢的其他商品 |
| **ALS（交替最小二乘）** | 矩阵分解     | 将用户行为矩阵分解为用户和商品的潜在向量，用于打分和相似度计算 |
| **NeuralMF**            | 深度矩阵分解 | 利用神经网络学习非线性打分函数，比 ALS 更灵活，支持更多特征输入 |

### 📌 **具体举例**

#### 🧾 场景设定：

> **用户A**最近在某电商平台上，通过广告点击并浏览了商品X（洗面奶）、商品Y（牙刷），并加购了商品Z（洗发水）。这些行为被广告主上报回平台，作为召回训练数据。

#### ✅ **1. ItemCF 示例**

- **原理：** 找出与商品 X/Y/Z 相似的商品（相似度 = 被同一批人喜欢的频率）。
- **召回结果：** 用户 A → 召回商品 Q（沐浴露）、商品 R（护发素），因为其他用户也同时购买了这些商品。

#### ✅ **2. ALS 示例**

- **原理：** 构建稀疏用户-商品行为矩阵（加购/下单打1），用矩阵分解学习潜在兴趣向量。
- **召回结果：** 用户 A 向量 ⋅ 所有商品向量 → 打分排序，推荐商品 T（面膜）、商品 U（剃须刀）。

#### ✅ **3. NeuralMF 示例**

- **原理：** 使用 Embedding 层建模用户与商品交互，融合其他上下文特征，如时间、品类偏好等。
- **召回结果：** 预测用户 A 对未浏览商品的偏好度，推荐商品 V（牙线）和商品 W（男士护肤套装），提升召回个性化能力。

#### 问题

广告索引 ？

用户标签数据？

好看队列：

| **召回队列名称**               | **模块分类**  | **召回类型/模型**        | **作用说明**                                     |
| ------------------------------ | ------------- | ------------------------ | ------------------------------------------------ |
| `grc_haokan_general_cb`        | 好看视频      | Content-Based            | 通用内容特征相似召回                             |
| `grc_haokan_general_session`   | 好看视频      | Session-Based            | 通用行为会话序列召回，短期兴趣捕捉               |
| `grc_haokan_content`           | 好看视频      | 内容画像/标签召回        | 基于内容特征的标准召回方式                       |
| `grc_haokan_session`           | 好看视频      | Session-Based            | 用户近期行为建模召回（行为序列匹配）             |
| `grc_haokan_ernie`             | 好看视频      | NLP 模型（ERNIE）        | 使用语义理解模型召回内容                         |
| `grc_haokan_fluid`             | 好看视频      | 热门池/流动池召回        | 热点内容召回或流动内容池召回                     |
| `grc_haokan_ec_video`          | 好看视频      | 电商召回                 | 电商/带货内容相关视频召回                        |
| `grc_haokan_local_video`       | 好看视频      | 地域定制召回             | 本地生活/地域定制内容召回                        |
| `new haokan itemcf service`    | 好看视频      | ItemCF                   | 好看平台新版协同过滤召回模块                     |
| `grc_content_based`            | 通用推荐      | 内容画像/标签召回        | 标准内容标签或向量匹配的召回                     |
| `grc_direct`                   | 通用推荐      | 直推通道                 | 强运营内容、手工配置内容直推                     |
| `grc_usercf`                   | 通用推荐      | UserCF                   | 基于相似用户行为召回                             |
| `grc_matchnet`                 | 通用推荐      | 深度匹配模型（MatchNet） | 使用深度模型对用户与内容进行匹配召回             |
| `grc_itemcf`                   | 通用推荐      | ItemCF                   | 基于相似内容物品行为召回                         |
| `grc_graphcf`                  | 通用推荐      | 图协同过滤               | 基于用户-内容图谱结构的关系进行召回              |
| `grc_recovery`                 | 通用推荐      | 冷启动/兜底召回          | 用于无历史用户、异常缺内容等情况的兜底策略召回   |
| `grc_long_video`               | 视频推荐      | 长视频召回               | 播放时长较长的内容召回（如电视剧、纪录片）       |
| `grc_video_micro_rec`          | 视频推荐      | 微视频召回               | 短小视频（如15秒以内内容）的召回                 |
| `grc_live_mid_stage`           | 直播推荐      | 中腰部主播召回           | 中层流量主播内容召回，兼顾质量与曝光             |
| `grc_live_mid_stage_dianshang` | 直播+电商推荐 | 电商直播召回             | 中腰部电商主播直播内容召回                       |
| `video_direct`                 | 视频推荐      | 直推                     | 重要内容直接推荐，如PGC内容、核心KOL、活动内容等 |
| `shoubai_gcf`                  | 手百内容推荐  | 图召回（GraphCF）        | 使用图结构进行内容与用户关联召回                 |
| `shoubai fork_resource_expand` | 手百内容推荐  | 分叉资源扩展召回         | 多通道扩展资源召回策略                           |
| `shoubai query gcf`            | 手百内容推荐  | Query图召回              | 基于用户查询内容的图召回策略                     |
